---
title: Решение и метод обработки внезапно недействительного ключа SSH
authors:
  - name: Yashin
    url: https://gitee.ru/yashin
origin-url: https://gitee.ru/help/articles/4352
---

Возникшие проблемы

OpenSSH 8.8, выпущенный 26 сентября 2021 года, удаляет поддержку RSA-SHA1.

> - Последняя версия 'git for windows 2.33.1' использует 'OpenSSH 8.8'.
> - Скользящие обновления таких дистрибутивов, как arch и manjaro, довольно агрессивны. Использование `pacman -Syu` обновит все программное обеспечение до последней версии.
- На данный момент все работает нормально, использование `pacman -Syu` или обновление до `git for windows 2.33.1` и последующее использование `git pull` приведет к появлению сообщения `fatal: could not read remote repository`.

Если вы обновитесь до версии 'OpenSSH 8.8' или выше, то при использовании SSH для push/pull кода Gitee произойдет сбой верификации.
> ![Описание изображения](https://images.gitee.ru/uploads/images/2021/1014/110518_2fa9dedc_4764813.png )
> ![Описание изображения](https://images.gitee.ru/uploads/images/2021/1014/110856_78e3d7d4_4764813.png )

### Причина

Мы используем `golang.org/x/crypto/ssh` для извлечения отпечатка пальца из открытого ключа и обмена пользовательской информацией с основным приложением Gitee.

В настоящее время (2021-10-12) этот репозиторий не поддерживает алгоритм `RSA-SHA2`, что приводит к невозможности получения отпечатка пальца и сбою верификации пользователя.

### Временное решение

Выберите одно из следующих трех решений

Настройте службу OpenSSH так, чтобы она разрешала использование ключа `RSA-SHA1`.

```bash
# Add the following configuration in ~/.ssh/config
Host gitee.ru 
HostkeyAlgorithms +ssh-rsa 
PubkeyAcceptedAlgorithms +ssh-rsa
```

> PS: Этот метод не требует изменения ключа SSH. Рекомендуется для пользователей Linux и Windows Git Bash.

1. Сгенерируйте ключ ssh, используя другой алгоритм

```bash
ssh-keygen -t ed25519 -C "your@example.email"
# После этого заново добавьте открытый ключ в Gitee.
```

> PS: Этот метод требует изменения ключа SSH. Рекомендуется для пользователей `windows`

1. Временно не используйте `OpenSSH 8.8` и более поздние версии

### Заключение

В настоящее время сообщество golang заметило эту ситуацию и продвигает поддержку `RSA-SHA2`, [подробности](https://github.com/golang/go/issues/37278)

Мы будем следить за прогрессом и сообщим, как только golang поддержит `RSA-SHA2`. Благодарим вас за поддержку `Gitee`.

### Ссылки на ссылки

[openssh-release-note-8.8](https://www.openssh.com/txt/release-8.8)