---
title: Модульное тестирование Nodejs
description: Модульное тестирование Nodejs
slug: /enterprise/pipeline/plugin/nodejs-unit-test
keywords:
 - Gitee
 - Nodejs
 - Npm
 - Yarn
 - Модульное тестирование
---

## Знакомство с формой

Выберите подходящую версию Node из выпадающего списка, и плагин инициализирует окружение Node на основе выбранной версии во время выполнения.

- **Команда test**: Команда test - это пользовательская команда для тестирования. Команда выполняется в корневом каталоге репозитория кода и поддерживает доступ к переменным окружения с помощью ${parameter key}. Обратите внимание, что добавление 'set -e' может управлять автоматическим завершением команд сценария при возникновении ошибки.

```shell
# Set NPM source to improve installation speed
npm config set registry https://registry.npmmirror.com
# Enter the test command here, the test report only supports the Mocha testing framework
npm install && npm run test
```

- Каталог тестовых отчетов: Каталог отчета о тестировании - это каталог, в котором находится отчет о тестировании, созданный после выполнения команды тестирования, например, mochawesome-report

- **Файл отчета о тестировании**: Файл отчета о тестировании - это имя файла отчета о тестировании в формате JSON, например, `mochawesome.json`.

- **Файл записи отчета о тестировании**: Файл записи отчета о тестировании - это имя файла записи отчета о тестировании в формате HTML, например, `mochawesome.html`.

- **Ворота качества**: В плагине тестирования можно настроить ворота качества. Если фактические показатели во время выполнения задачи будут ниже настроенных, в действие вступят ворота. Задача конвейера будет помечена как неудачная, и последующие задачи не будут выполняться.
  - Коэффициент прохождения теста: Процент прохождения тестов

- **Кэш сборки**:

> По умолчанию каталог кэша для npm выглядит так: ~/.npm, но вы можете настроить путь кэша с помощью командной строки npm: npm config set cache /root/xxx/.npm. Если в конвейере установлен каталог кэша по умолчанию (~/.npm), он станет недействительным и его нужно будет изменить на (/root/xxx/.npm). Параметр cache поддерживает абсолютные и относительные пути. Например:

- ~/.npm
- xxx/xxx относительно корневого каталога репозитория кода
- /root/workspace/xxx

> Объяснение правила:

- Так называемый кэш по сути означает хранение модулей, которые неоднократно используются в нашем конвейере, в загруженном S3. Когда конвейер запускается снова, файл кэша загружается и извлекается из S3.
Только после успешной сборки конвейера обновленные файлы кэша будут загружены.
- Срок действия файлов кэша по умолчанию истекает через 30 дней.
- Каждое срабатывание конвейера может продлить срок действия кэша (даже если сборка не удалась)