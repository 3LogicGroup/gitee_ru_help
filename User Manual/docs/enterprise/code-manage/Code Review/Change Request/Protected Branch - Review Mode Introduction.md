---
title: Знакомство с защитой веток - режим просмотра
origin-url: https://gitee.ru/help/articles/4346
---

> Теперь Gitee может перевести защищенную ветку в **Режим Просмотра**, при котором любая неразрешенная отправка в эту ветку автоматически создаст (или обновит) ее.

Трудно сказать, все ли разработчики сталкивались с этим. Получив задание, мы должны пройти следующий процесс, чтобы завершить его:

1. Обновить магистральную ветку локально, создать и переключиться на новую ветку на основе магистральной ветки
2. Написать код...
3. Перенести эту ветку на удаленный сервер
4. Открыть Gitee и перейти на страницу создания запроса на слияние
5. Выбрать целевую ветку
6. Заполнить заголовок и описание
7. Нажать "Отправить запрос на слияние".

На этом этапе некоторым студентам это может показаться громоздким:

- "Почему я должен писать это снова, когда в задании уже указаны изменения, которые необходимо внести, и последующие тестовые примеры?"
- "Я уже предоставил подробную информацию о клммите, поэтому нет необходимости повторять ее".
- "Разве вы не можете автоматически создать для меня запрос на слияние, если я не могу нажать, а затем автоматически связать задачи, связанные с веткой?"
- ...

Итак, есть ли способ быстро создать запрос на слияние?

Ответ таков: **Да!**

### **Изменить последний коммит**

Чтобы решить проблему громоздкого процесса создания вышеупомянутого запроса на слияние, мы расширили защищенную ветку и разделили ее на два режима:

- Стандартный режим: Соответствует исходной логике защищенной ветки, строго следует разрешениям на отправку и слияние. Если разрешения нет, отправка будет отклонена.
- Режим просмотра: Единственное отличие от стандартного режима заключается в том, что, если у пользователя нет прав на отправку, его отправка автоматически создаст (или обновит) запрос на слияние.

![Описание изображения](../../../../../assets/image164.png)
![Описание изображения](../../../../../assets/image165.png)

Сюда, в **Управлениие репозиторием - Настройки защищенной ветки **, я добавил правило проверки защищенной ветки и установил его в режим проверки и запретил кому-либо отправлять. Итак, независимо от того, кто (при условии, что они являются участниками репозитория) отправляет код в ветку проверки, он автоматически создаст запрос на слияние:

![Описание изображения](./assets/150632_2426aa33_62561.webp)

Как вы можете видеть, сервер идентифицировал проверяемую ветку как защищенную ветку в режиме проверки, и у меня нет разрешения на отправку в эту ветку (поскольку она настроена таким образом, что совершать отправку запрещено кому бы то ни было ). Gitee автоматически создал запрос на извлечение из моего отправленного коммита в ветку проверки и предоставил адрес для доступа.

Если я выполню еще один коммит и снова выполню отправку, Gitee обнаружит, что у меня уже был запрос на слияние, автоматически созданный в этой ветке, и автоматически обновит код этого запроса на слияние.

![Описание изображения](./assets/154106_2ca73096_62561.webp)

На этом этапе, если мы перейдем к Gitee, мы увидим, что автоматически созданный запрос на слияние был обновлен.

![Описание изображения](../../../../../assets/image166.png)
![Описание изображения](../../../../../assets/image167.png)

Кроме того, вы можете напрямую обновить автоматически созданную исходную ветку, чтобы обновить запрос на слияние, которым является созданная выше ветка auto-62561-review-1625833887273. Конкретные шаги выглядят следующим образом:

```bash
git fetch 
git checkout auto-62561-review-1625833887273
// Coding...
git add {xxfile}
git commit -m "update auto pr"
git push origin auto-62561-review-1625833887273
```

### **Автоматическое создание и обновление правил запроса на слияние**

Коммит, отправленный в защищенную ветку в режиме проверки, должен полностью учитывать различия определенного запроса на слияние.

Мы заключаем следующие соглашения

- удаленное представляет удаленное, 
локальное представляет локальное
- результат представляет результат
- 1-2-3-4 представляет четыре коммита, последним из которых является 4.
- Запрос на слияние представляет запрос на извлечение

Мы предполагаем, что в удаленном компьютере есть четыре коммита: `удаленное: 1-2-3-4`

```bash
Case1
local: 1-2-3-4-5
result: Created PR-a containing 5.

Case2
local: 1-2-3-4-5-6
result: Updated PR-a includes 5-6 (Because there is already a PR, and this version is the parent of the differences in this PR, so it can be updated).

Case3
local: 1-2-3-4-5-7 Modified submission 6 to submission 7 (revert or commit --amend operation)
result: Created PR-b includes 5-7 (The existing PR is not a subset of this version, this version does not include 6, so create a new PR)
```

### **Рекомендуемое использование**

Хотя обеспечиваемое режимом проверки автоматическое создание запроса на слияние удобно, оно может сбить разработчиков с толку, если они будут постоянно переключать ветки. Поэтому предлагаются два рекомендуемых способа использования для обеспечения организованной разработки при одновременном повышении производительности.

**1. Разработка локальной ветки**

![Описание изображения](./assets/163512_b2692312_62561.webp)

**II. Разработка локальной магистральной ветки**

![Описание изображения](./assets/163759_e32154c4_62561.webp)

Приходите и попробуйте!