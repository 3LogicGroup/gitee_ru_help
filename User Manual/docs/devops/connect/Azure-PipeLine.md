---
title: Как использовать Azure Pipeline для создания проектов на Gitee

origin-url: https://gitee.ru/help/articles/4230
---

Прежде чем начать
- [Знакомство с Azure Pipeline](#Знакомство-с-Azure-Pipeline)
Настройка среды
- [Процесс сборки конвейера данных](#Процесс-сборки-конвейера-данных)
  - [Привязка к репозиторию Git](#Привязка-к-репозиторию-Git)
  - [Настройка процесса сборки](#Настройка-процесса-сборки)
  - [Завершение первой сборки](#Завершение-первой-сборки)
- [Ссылка на информацию о состоянии сборки в репозиториях Gitee](#Ссылка-на-информацию-о-состоянии-сборки-в-репозиториях-Gitee)
Обеспечение непрерывной интеграции
- [Заключение](#Заключение)

## Введение

При непрерывной интеграции "Конвейер данных" разбивает задачи сборки/развертывания на несколько частей и соединяет их для формирования задания конвейеру, которое автоматически запускается/выполняется по расписанию программами для достижения автоматизации задач.

Уже существует множество платформ, поддерживающих функциональность `Конвейера данных`. В этой статье основное внимание будет уделено тому, как "Gitee" может интегрироваться с "Azure" для автоматической сборки, тестирования и развертывания кода, управления версиями кода, артефактами и отчетами о тестировании, а также выполнения тестирования и развертывания с различными уровнями детализации.

## Знакомство с Azure Pipeline

`Azure Pipeline` - это часть экосистемы непрерывной интеграции `Azure Devops`, запущенной компанией Microsoft, ранее известной как `VSTS`. В настоящее время `Azure Pipeline` поддерживает создание и развертывание таких языков, как "Node.js", "Python", "Java", "PHP", "Ruby", "C"/"C++", ".NET", "Android", "iOS" на облачных платформах под управлением `Linux`, `macOS` и `Windows`. Это очень мощный инструмент.

Кроме того, Azure Pipelines бесплатно предоставляет неограниченное по времени обслуживание непрерывной интеграции и развёртывания программного обеспечения и 10 параллельных заданий для проектов с открытым исходным кодом. Все проекты с открытым исходным кодом запускаются бесплатно в одной инфраструктуре, что означает, что они имеют одинаковую производительность и качество обслуживания. Это чрезвычайно удобно и экономит разработчикам затраты, которые им приходится оплачивать.

Более подробную информацию можно получить, посетив [Знакомство с Azure Pipeline].

## Настройка среды

Прежде чем начать изучение того, как использовать [Azure Pipeline] для создания проекта в [Gitee], нам необходимо подготовить следующий контент:

- Учетная запись в [Gitee]
- Учетная запись Microsoft
- Разместите на Gitee готовый к сборке проект. В этой статье в качестве примера мы рассмотрим "layui".

> Общая схема работы обычного конвейера выглядит следующим образом:
>
> - Пользователь отправляет код в репозиторий Git
> - Сервис конвейера данных извлекает последн.юю версию кода из репозитория Git
> - Сервис конвейера данных последовательно выполняет задачи сборки/развертывания  на основе настроенного рабочего процесса.

## Процесс сборки конвейера данных

Получите доступ и войдите в систему под своей учетной записью Microsoft на домашней странице Azure Devops. При первом посещении вам будет предложено создать организацию.

![](https://images.gitee.ru/uploads/images/2018/1105/105541_3cbff4f6_551147.png )

![](https://images.gitee.ru/uploads/images/2018/1105/105548_ded0910a_551147.png )

Нажав "Продолжить", введите название организации и регион в соответствии с подсказкой и нажмите "Создать". Вам будет предложено создать проект Devops. Здесь вам нужно только заполнить "Название проекта" и "Описание", выбрать "Общедоступный" для типа проекта и нажать "Создать проект".

![](https://images.gitee.ru/uploads/images/2018/1105/105604_b31f6928_551147.png )

После создания будет получена следующая консоль, поэтому в данной статье основное внимание будет уделено функциям разделов "Конвейеры".

![](https://images.gitee.ru/uploads/images/2018/1105/105614_bab2fc03_551147.png )

Нажмите на меню ** "Конвейеры"** -> **"Сборки"**, и, когда вы создадите первые "Конвейеры", появится уведомление о том, что `Конвейеров` еще нет. Итак, для перехода к процессу создания "Конвейеров" нажмите на ** "Создать конвейер данных"**.

![](https://images.gitee.ru/uploads/images/2018/1105/105620_fe4e6c60_551147.png )

### Привязка к репозиторию Git

При первом создании конвейеров данных вам необходимо связать с проектом репозиторий Git. В этой статье в качестве примера мы будем использовать [layui]. Мы уже заранее создали форк проекта [layui] на учетную запись Gitee, и адрес выглядит следующим образом: [https://gitee.ru/normalcoder/layui](https://gitee.ru/normalcoder/layui).

В то же время вы добавили SSH-ключ для интегрированной сборки и развертывания на главной странице репозитория, перейдя в "Управление" -> "Управление ключами развертывания" -> "Добавить ключ". Для получения дополнительной информации о конкретных операциях с SSH-ключом вы можете посетить [Справочный центр Gitee - Настройки SSH-ключа]. Мы не будем вдаваться здесь в подробности.

![](https://images.gitee.ru/uploads/images/2018/1105/105631_674a0466_551147.png )

Вернитесь в Azure Pipeline и нажмите "Использовать визуальный дизайнер" на первом шаге создания конвейера. В представлении пользовательского репозитория выберите "Внешний Git" и добавьте информацию о нашем репозитории Git и авторизованный SSH-ключ развертывания через "Добавить соединение".

![](https://images.gitee.ru/uploads/images/2018/1105/105640_3c6f9cf4_551147.png )

![](https://images.gitee.ru/uploads/images/2018/1105/105645_81a12c1a_551147.png )

![](https://images.gitee.ru/uploads/images/2018/1105/105655_3bbbce88_551147.png )

По завершении настройки вы получите сообщение об успешном доступе к репозиторию, и вам будет предложено выбрать информацию о ветке для сборки. Здесь по умолчанию выбрано **'задатчик'**, для продолжения нажмите **'Продолжить'**.

![](https://images.gitee.ru/uploads/images/2018/1105/105706_97a21531_551147.png )

Настройка процесса сборки

Далее выберите процесс сборки. `Azure Devops` предоставляет множество шаблонов процессов сборки, а кроме того, вы можете определить свои собственные процессы сборки и развертывания. 

![](https://images.gitee.ru/uploads/images/2018/1105/105743_d360972a_551147.png )

После выбора типа сборки нужно настроить детали сборки, включая указание операционной системы среды сборки и т. д. В данном случае была выбрана сборка на базе macOS. Поскольку сборка [layui] несложна, можно использовать стандартное решение для выполнения сборки напрямую. Чтобы сохранить внесенные изменения, нажмите **"Сохранить и поставить в очередь"** -> **"Сохранить"**.

![](https://images.gitee.ru/uploads/images/2018/1105/105751_d8db191f_551147.png )

### Завершение первой сборки

Вернитесь в **"Конвейеры данных"** -> **"Сборки"**, выберите созданный вами конвейер и выберите **"Поставить в очередь"** или **"Запустить"**, чтобы начать вашу первую сборку.

![](https://images.gitee.ru/uploads/images/2018/1105/105759_12e10623_551147.png )

Выберите среду сборки на основе macOS. По умолчанию используется ветка 'задатчик'. Здесь вам нужно указать 'коммит' для этой версии сборки.

![](https://images.gitee.ru/uploads/images/2018/1105/105807_5fe88569_551147.png )

После нажатия на "Собрать" вы увидите текущий статус задачи сборки в разделе **"История "** справа. Щелкнув по деталям задачи, можно просмотреть содержимое в процессе сборки.

![](https://images.gitee.ru/uploads/images/2018/1105/105816_51096e36_551147.png )

## Ссылка на информацию о состоянии сборки в репозиториях Gitee

Вернитесь к списку задач сборки, на странице подробной информации `конвейера данных` предусмотрена возможность связать и предоставить в реальном времени обратную связь о состоянии сборки в репозитории с помощью **"Индикатора статуса"**.

![](https://images.gitee.ru/uploads/images/2018/1105/105903_3e4963ed_551147.png )

Скопируйте колонку "Образец Markdown" в **"Индикаторе статуса"** и добавьте информацию в формате `Markdown` в файл **Readme.md** репозитория Git. После добавления эффект будет таким, как показано на рисунке.

![](https://images.gitee.ru/uploads/images/2018/1105/105912_ac703851_551147.png )

## Обеспечение непрерывной интеграции

По завершении выполнения переноса проекта из 'Gitee' в 'Azure Devops', в целях обновления кода и 

запуска непрерывной интеграции для репозитория откройте опцию "Включить непрерывную интеграцию" во вкладке "Триггеры" информации о конвейере данных проекта. Разъяснение по опциям дано ниже:

Временной интервал опроса (секунды): Azure будет периодически создавать репозиторий на основе настроенного интервала времени опроса в секундах.
- Фильтры веток: Используется для определения того, какие ветки создавать в процессе непрерывной интеграции, поддерживает условную композицию.

![](https://images.gitee.ru/uploads/images/2018/1105/105923_06dcc257_551147.png )

## Заключение

Путем интеграции репозитория кода Gitee с конвейерами Azure Devops разработчики могут легко завершить работу по непрерывной интеграции (CI) проекта. Они могут постоянно получать отзывы о проекте  и вносить улучшения, тем самым повышая эффективность и сокращая цикл разработки. Им не нужно ждать более поздних стадий цикла разработки, чтобы найти и устранить дефекты. Непрерывная интеграция играет решающую роль в процессе разработки для современных технологий разработки программного обеспечения и заслуживает всеобщего внимания и изучения.

[Gitee]:https://gitee.ru
[Gitee]:https://gitee.ru
[Домашняя страница Azure Devops]: https://dev.azure.com/
[Azure Pipeline]:https://azure.microsoft.com/zh-cn/services/devops/pipelines/
Знакомство с Azure Pipeline: https://azure.microsoft.com/zh-cn/services/devops/pipelines/
[layui]:https://gitee.ru/sentsin/layui
[Справочный центр Gitee - Настройки открытых SSH-ключей]:https://gitee.ru/help/articles/4191